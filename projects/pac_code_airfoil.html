<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="title" content=" | Mark Miller Jr. | Professional Portfolio">
    <meta name="description" content="">
    <meta name="image" content="https://github.com/markdmillerjr.png">
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="Mark Miller Jr. | Professional Portfolio">
    <meta property="og:url" content="https://markdmillerjr.github.io/projects/pac_code_airfoil.html">
    <meta property="og:title" content=" | Mark Miller Jr. | Professional Portfolio">
    <meta property="og:description" content="">
    <meta property="og:image" content="https://github.com/markdmillerjr.png">
    <link rel="shortcut icon" href="/shockwave.ico">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-0evHe/X+R7YkIZDRvuzKMRqM+OrBnVFBL6DOitfPri4tjfHxaWutUpFmBp4vmVor" crossorigin="anonymous">
    <link rel="stylesheet" href="/css/techfolio-theme/rubik.css">
    <link rel="stylesheet" type="text/css" href="/css/rouge/github.css">
    <!-- Load MathJax if 'mathjax: true' is found in your _config.yml. -->
    
    <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-MML-AM_CHTML">
    </script>
    

    <title> | Mark Miller Jr. | Professional Portfolio</title>
  </head>
  <body>
  <header class="navbar navbar-expand navbar-light bg-light bg-gradient border-bottom">
  <div class="container-fluid">
    <a class="navbar-brand" href="/">Mark Miller</a>
    <div class="ms-auto">
      <ul class="navbar-nav mb-2 mb-lg-0">
        <a class="nav-link" href="/#projects">Projects</a>
        <a class="nav-link" href="/resume.html">Resume</a>
      </ul>
    </div>
  </div>
</header>

<div class="container py-4">
  <h1 class="display-4"></h1>
 <h3>Combined Airfoils Code</h3>

<p>The first, the ability to model a wing with a different root and tip airfoil was much more difficult than originally anticipated. The difficulty has to do with how MATLAB graphs an object. As alluded on the <b>Background</b> page, graphing a single airfoil is trivial, along with extending that approach out to a wing. Each airfoil has a set of coordinates that describe its shape along the X-Y axis. The wing is plotted by drawing a line from the trailing edge of the first airfoil to the trailing edge of the second airfoil. A line is then drawn along the airfoil cross-section to the next X-coordinate. Another line is then drawn from the second airfoil to the first airfoil. Finally, a line is drawn along the airfoil cross-section again to complete the face. As shown under <b>Wing Plotting Steps</b> this process is repeated across the entire airfoil cross-section.</p>

<iframe type="text/html" src="naca2412.html" width="150" height="700"></iframe>

<p><br /></p>

<h5>Wing Plotting Steps</h5>
<div class="text-center p-4">
    <img width="600px" src="../img/pac_project/wing_plotting_steps/wing1.png" class="img-thumbnail" />
    <img width="600px" src="../img/pac_project/wing_plotting_steps/wing2.png" class="img-thumbnail" />
    <img width="600px" src="../img/pac_project/wing_plotting_steps/wing3.png" class="img-thumbnail" />
    <img width="600px" src="../img/pac_project/wing_plotting_steps/wing4.png" class="img-thumbnail" />
    <img width="600px" src="../img/pac_project/wing_plotting_steps/wing5.png" class="img-thumbnail" />
    <img width="600px" src="../img/pac_project/wing_plotting_steps/wing6.png" class="img-thumbnail" />
    <img width="600px" src="../img/pac_project/wing_plotting_steps/wing7.png" class="img-thumbnail" />
    <img width="600px" src="../img/pac_project/wing_plotting_steps/wing8.png" class="img-thumbnail" />
    <img width="600px" src="../img/pac_project/wing_plotting_steps/wing9.png" class="img-thumbnail" />
    <img width="600px" src="../img/pac_project/wing_plotting_steps/wing10.png" class="img-thumbnail" />
</div>

<p>Here is a snippet of the code that draws one segment of the wing.</p>

<div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">for</span> <span class="n">t</span> <span class="o">=</span> <span class="mi">1</span><span class="p">:</span><span class="n">airfoil_size</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">t</span> <span class="o">&lt;=</span> <span class="n">airfoil_size</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="n">XWRT</span> <span class="o">=</span> <span class="p">[((</span><span class="n">airfoil_coords_x</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">XW1</span><span class="p">)</span> <span class="o">*</span> <span class="n">c</span><span class="p">)</span> <span class="o">-</span> <span class="n">c</span><span class="p">,</span> <span class="p">((</span><span class="n">airfoil_coords_x</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">.*</span> <span class="n">tp</span> <span class="o">+</span> <span class="n">XW2</span><span class="p">)</span> <span class="o">*</span> <span class="n">c</span><span class="p">)</span> <span class="o">-</span> <span class="n">c</span><span class="p">,</span><span class="k">...</span>
            <span class="p">((</span><span class="n">airfoil_coords_x</span><span class="p">(</span><span class="n">t</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.*</span> <span class="n">tp</span> <span class="o">+</span> <span class="n">XW2</span><span class="p">)</span> <span class="o">*</span> <span class="n">c</span><span class="p">)</span> <span class="o">-</span> <span class="n">c</span><span class="p">,</span> <span class="p">((</span><span class="n">airfoil_coords_x</span><span class="p">(</span><span class="n">t</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">XW1</span><span class="p">)</span> <span class="o">*</span> <span class="n">c</span><span class="p">)</span> <span class="o">-</span> <span class="n">c</span><span class="p">];</span>
        <span class="n">YWRT</span> <span class="o">=</span> <span class="p">[(</span><span class="n">airfoil_array</span><span class="p">(</span><span class="mi">1</span><span class="p">)),</span> <span class="p">(</span><span class="n">airfoil_array</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span> <span class="p">/</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="n">airfoil_array</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span> <span class="p">/</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="n">airfoil_array</span><span class="p">(</span><span class="mi">1</span><span class="p">))];</span>
        <span class="n">ZWRT</span> <span class="o">=</span> <span class="p">[((</span><span class="n">airfoil_coords_y</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">ZW1</span><span class="p">)</span> <span class="o">*</span> <span class="n">c</span><span class="p">)</span> <span class="o">-</span> <span class="n">c</span><span class="p">,</span> <span class="p">((</span><span class="n">airfoil_coords_y</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">.*</span> <span class="n">tp</span> <span class="o">+</span> <span class="n">ZW2</span><span class="p">)</span> <span class="o">*</span> <span class="n">c</span><span class="p">)</span> <span class="o">-</span> <span class="n">c</span><span class="p">,</span><span class="k">...</span>
            <span class="p">((</span><span class="n">airfoil_coords_y</span><span class="p">(</span><span class="n">t</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.*</span> <span class="n">tp</span> <span class="o">+</span> <span class="n">ZW3</span><span class="p">)</span> <span class="o">*</span> <span class="n">c</span><span class="p">)</span> <span class="o">-</span> <span class="n">c</span><span class="p">,</span> <span class="p">((</span><span class="n">airfoil_coords_y</span><span class="p">(</span><span class="n">t</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">ZW4</span><span class="p">)</span> <span class="o">*</span> <span class="n">c</span><span class="p">)</span> <span class="o">-</span> <span class="n">c</span><span class="p">];</span>
        <span class="n">WRT</span>  <span class="o">=</span> <span class="nb">fill3</span><span class="p">(</span><span class="n">XWRT</span><span class="p">,</span> <span class="n">YWRT</span><span class="p">,</span> <span class="n">ZWRT</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.5</span> <span class="mf">0.5</span> <span class="mf">0.5</span><span class="p">]);</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">t</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">end</span>
<span class="k">end</span>

</code></pre></div></div>
<p>Now all of this is simple to understand and use. You want to plot a wing, input the airfoil coordinates and you’re done. The problem is what if you want to plot a wing with a different airfoil for the root and tip? If the number of points in both airfoils are the same, then it’s no big deal, it works the same way. However, what if the tip airfoil has more points than the root airfoil, or vice versa?</p>

<p>Suppose we wish to create a wing with a NACA 2412 airfoil for the root and a NACA 63(1)-212 airfoil for the tip. The 2412 has 35 points along it’s cross-section, while the 63(1)-212 has 141.</p>
<div>
    <iframe type="text/html" src="naca2412.html" width="150" height="3200"></iframe>
    <iframe type="text/html" src="NACA63-212.html" width="150" height="3200"></iframe>
</div>

<div>
    <img class="img-fluid" src="../img/pac_project/root.png" />
    NACA 2412
    <img class="img-fluid" src="../img/pac_project/tip.png" />
    NACA 63(1)-212
</div>

<p><br /></p>

<p>The difficulty is in how an airfoil is constructed. What you need to do then is increase the size of the array of the NACA 2412 airfoil to equal the NACA 63(1)-212. The problem is ensuring that the increased array is the same geometric shape and size as a standard NACA 2412. Each point that is added to the 2412 airfoil has to be at the same X-Axis location as the 63(1)-212 airfoil for MATLAB to plot a face connecting those segments as shown in the above steps. Enlarging the 2412 is straightforward enough, just increase the size of the array and ensure the Y-Axis points correspond to the correct X-Axis points. Once you have this enlarged array, you need to fill in the X-Axis location gaps (gaps because the 2412 has X-Axis points from 0.9, 0.95, 1 while the 63(1)-212 has X-Axis points from 0.968…, 0.987…, 1) with the points from the 63(1)-212.</p>

<p>The tricky part is that for each of these extra filled in points, you need to calculate the corresponding Y-Axis point that still fits geometrically with the original airfoil. You can do this by calculating the slope of the corresponding segment as, m = (y2 - y1) / (x2 - x1), where m is the slope of the segment and y2 and y1 are the Y-Axis points and x2 and x1 are the X-Axis points respectively. Also knowing the slopes of each segment isn’t enough, you also need to know it’s position on the airfoil. In other words, the slope is found from the local coordinates between each segment, you also need the global coordinates of the full airfoil to understand where to place the Y-Axis point for each X-Axis point that was filled in.</p>

<p>Initial attempts at working the problem.
<img class="img-fluid" src="../img/pac_project/combined_airfoils1.png" /></p>

<p><img class="img-fluid" src="../img/pac_project/combined_airfoils2.png" /></p>

<p>Finally, this process needs to be completed for both airfoils, to ensure that their X-Axis points line up and the Y-Axis points are in the correct location. After this is complete, the full wing can be plotted.</p>

<p>The following snippets of code are the MATLAB implementations of the process described above.</p>

<p>Code that fills in gaps after smaller airfoil is enlarged.</p>

<div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code>        <span class="c1">% Following code places all of the original airfoil Y-Axis points</span>
        <span class="c1">% on the new combined airfoil X-Axis points. The location of each</span>
        <span class="c1">% Y-Axis point is the same as that of the original airfoil,</span>
        <span class="c1">% ensuring that the new combined airfoil is the same geometrically</span>
        <span class="c1">% as the original just a larger array</span>
        
        <span class="c1">% Initialize necessary arrays</span>
        <span class="n">comboAirfoilSize</span>       <span class="o">=</span> <span class="nb">length</span><span class="p">(</span><span class="n">comboAirfoil_coords_xRoot</span><span class="p">);</span>
        <span class="n">findYLocationArrayRoot</span> <span class="o">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="n">airfoil_sizeRoot</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
        <span class="n">rearrangedYArray</span>       <span class="o">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="n">comboAirfoilSize</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
        <span class="n">midpointRoot</span>           <span class="o">=</span> <span class="nb">find</span><span class="p">(</span><span class="n">airfoil_coords_xRoot</span> <span class="o">==</span> <span class="nb">min</span><span class="p">(</span><span class="n">airfoil_coords_xRoot</span><span class="p">));</span>
        <span class="n">midpointCombo</span>          <span class="o">=</span> <span class="nb">find</span><span class="p">(</span><span class="n">comboAirfoil_coords_xRoot</span> <span class="o">==</span> <span class="nb">min</span><span class="p">(</span><span class="n">comboAirfoil_coords_xRoot</span><span class="p">));</span>
        
        <span class="c1">% Arrange the Y-cordinate points according to the order that they</span>
        <span class="c1">% were on the original airfoil</span>
        <span class="k">for</span> <span class="n">iRoot</span> <span class="o">=</span> <span class="mi">1</span><span class="p">:</span><span class="n">airfoil_sizeRoot</span><span class="p">(</span><span class="k">end</span><span class="p">)</span>
            <span class="n">intermediateArrayRoot</span> <span class="o">=</span> <span class="nb">find</span><span class="p">(</span><span class="n">comboAirfoil_coords_xRoot</span> <span class="o">==</span> <span class="n">airfoil_coords_xRoot</span><span class="p">(</span><span class="n">iRoot</span><span class="p">));</span>
            <span class="k">if</span> <span class="nb">length</span><span class="p">(</span><span class="n">intermediateArrayRoot</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="n">intermediateArrayRoot</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="n">iRoot</span> <span class="o">==</span> <span class="nb">false</span> <span class="o">&amp;&amp;</span> <span class="n">iRoot</span> <span class="o">&lt;</span> <span class="n">midpointRoot</span> <span class="o">==</span> <span class="nb">true</span> <span class="o">||</span><span class="k">...</span>
                        <span class="n">intermediateArrayRoot</span><span class="p">(</span><span class="k">end</span><span class="p">)</span> <span class="o">==</span> <span class="n">iRoot</span> <span class="o">==</span> <span class="nb">false</span> <span class="o">&amp;&amp;</span> <span class="n">iRoot</span> <span class="o">&lt;</span> <span class="n">midpointRoot</span> <span class="o">==</span> <span class="nb">true</span>
                    <span class="n">intermediateArrayRoot</span><span class="p">(</span><span class="k">end</span><span class="p">)</span> <span class="o">=</span> <span class="p">[];</span>
                    <span class="n">findYLocationArrayRoot</span><span class="p">(</span><span class="n">iRoot</span><span class="p">)</span> <span class="o">=</span> <span class="n">intermediateArrayRoot</span><span class="p">;</span>
                <span class="k">elseif</span> <span class="n">intermediateArrayRoot</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="n">iRoot</span> <span class="o">==</span> <span class="nb">false</span> <span class="o">&amp;&amp;</span> <span class="n">iRoot</span> <span class="o">&gt;</span> <span class="n">midpointRoot</span> <span class="o">==</span> <span class="nb">true</span> <span class="o">||</span><span class="k">...</span>
                        <span class="n">intermediateArrayRoot</span><span class="p">(</span><span class="k">end</span><span class="p">)</span> <span class="o">==</span> <span class="n">iRoot</span> <span class="o">==</span> <span class="nb">false</span> <span class="o">&amp;&amp;</span> <span class="n">iRoot</span> <span class="o">&gt;</span> <span class="n">midpointRoot</span> <span class="o">==</span> <span class="nb">true</span>
                    <span class="n">intermediateArrayRoot</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="p">[];</span>
                    <span class="n">findYLocationArrayRoot</span><span class="p">(</span><span class="n">iRoot</span><span class="p">)</span> <span class="o">=</span> <span class="n">intermediateArrayRoot</span><span class="p">;</span>
                <span class="k">else</span>
                    <span class="n">intermediateArrayRoot</span><span class="p">(</span><span class="k">end</span><span class="p">)</span> <span class="o">=</span> <span class="p">[];</span>
                    <span class="n">findYLocationArrayRoot</span><span class="p">(</span><span class="n">iRoot</span><span class="p">)</span> <span class="o">=</span> <span class="n">intermediateArrayRoot</span><span class="p">;</span>
                <span class="k">end</span>                
            <span class="k">else</span>
                <span class="n">findYLocationArrayRoot</span><span class="p">(</span><span class="n">iRoot</span><span class="p">)</span> <span class="o">=</span> <span class="n">intermediateArrayRoot</span><span class="p">;</span>
            <span class="k">end</span>
            
                <span class="k">if</span> <span class="nb">length</span><span class="p">(</span><span class="nb">find</span><span class="p">(</span><span class="n">findYLocationArrayRoot</span> <span class="o">==</span> <span class="n">intermediateArrayRoot</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span>      
                    <span class="n">tempFind</span> <span class="o">=</span> <span class="nb">find</span><span class="p">(</span><span class="n">findYLocationArrayRoot</span> <span class="o">==</span> <span class="n">intermediateArrayRoot</span><span class="p">);</span>
                    <span class="n">findYLocationArrayRoot</span><span class="p">(</span><span class="n">iRoot</span><span class="p">)</span> <span class="o">=</span> <span class="n">tempFind</span><span class="p">(</span><span class="k">end</span><span class="p">);</span>
                <span class="k">else</span>
                    <span class="n">findYLocationArrayRoot</span><span class="p">(</span><span class="n">iRoot</span><span class="p">)</span> <span class="o">=</span> <span class="nb">find</span><span class="p">(</span><span class="n">findYLocationArrayRoot</span> <span class="o">==</span> <span class="n">intermediateArrayRoot</span><span class="p">);</span>
                <span class="k">end</span>
                
                <span class="k">if</span> <span class="n">iRoot</span> <span class="o">~=</span> <span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="n">iRoot</span> <span class="o">&lt;</span> <span class="n">midpointRoot</span> <span class="o">&amp;&amp;</span> <span class="nb">length</span><span class="p">(</span><span class="nb">find</span><span class="p">(</span><span class="n">comboAirfoil_coords_xRoot</span> <span class="o">==</span> <span class="n">airfoil_coords_xRoot</span><span class="p">(</span><span class="n">findYLocationArrayRoot</span><span class="p">(</span><span class="n">iRoot</span><span class="p">))</span> <span class="o">==</span> <span class="mi">1</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span>
                    <span class="n">findYSortedRoot</span> <span class="o">=</span> <span class="n">comboAirfoil_coords_xRoot</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">midpointCombo</span><span class="p">)</span> <span class="o">==</span> <span class="n">airfoil_coords_xRoot</span><span class="p">(</span><span class="n">findYLocationArrayRoot</span><span class="p">(</span><span class="n">iRoot</span><span class="p">));</span>
                    <span class="n">extraZeros</span>  <span class="o">=</span> <span class="nb">false</span><span class="p">(</span><span class="n">comboAirfoilSize</span><span class="o">-</span><span class="nb">length</span><span class="p">(</span><span class="n">findYSortedRoot</span><span class="p">),</span><span class="mi">1</span><span class="p">);</span>
                    <span class="k">if</span> <span class="nb">isempty</span><span class="p">(</span><span class="n">extraZeros</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
                        <span class="n">extraZeros</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
                    <span class="k">end</span>
                    <span class="n">findYSortedRoot</span> <span class="o">=</span> <span class="p">[</span><span class="n">findYSortedRoot</span><span class="p">;</span><span class="n">extraZeros</span><span class="p">];</span>
                <span class="k">elseif</span> <span class="n">iRoot</span> <span class="o">~=</span> <span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="n">iRoot</span> <span class="o">&gt;</span> <span class="n">midpointRoot</span> <span class="o">&amp;&amp;</span> <span class="nb">length</span><span class="p">(</span><span class="nb">find</span><span class="p">(</span><span class="n">comboAirfoil_coords_xRoot</span> <span class="o">==</span> <span class="n">airfoil_coords_xRoot</span><span class="p">(</span><span class="n">findYLocationArrayRoot</span><span class="p">(</span><span class="n">iRoot</span><span class="p">))</span> <span class="o">==</span> <span class="mi">1</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span>
                    
                    <span class="n">findYSortedRoot</span> <span class="o">=</span> <span class="n">comboAirfoil_coords_xRoot</span><span class="p">(</span><span class="n">midpointCombo</span><span class="p">:</span><span class="k">end</span><span class="p">)</span> <span class="o">==</span> <span class="n">airfoil_coords_xRoot</span><span class="p">(</span><span class="n">findYLocationArrayRoot</span><span class="p">(</span><span class="n">iRoot</span><span class="p">));</span>
                    <span class="n">extraZeros</span>  <span class="o">=</span> <span class="nb">false</span><span class="p">(</span><span class="n">comboAirfoilSize</span><span class="o">-</span><span class="nb">length</span><span class="p">(</span><span class="n">findYSortedRoot</span><span class="p">),</span><span class="mi">1</span><span class="p">);</span>
                    <span class="n">findYSortedRoot</span> <span class="o">=</span> <span class="p">[</span><span class="n">extraZeros</span><span class="p">;</span><span class="n">findYSortedRoot</span><span class="p">];</span>
                <span class="k">else</span>
                    <span class="n">findYSortedRoot</span> <span class="o">=</span> <span class="n">comboAirfoil_coords_xRoot</span> <span class="o">==</span> <span class="n">airfoil_coords_xRoot</span><span class="p">(</span><span class="n">findYLocationArrayRoot</span><span class="p">(</span><span class="n">iRoot</span><span class="p">));</span>
                <span class="k">end</span>
                
            <span class="k">if</span> <span class="nb">length</span><span class="p">(</span><span class="nb">find</span><span class="p">(</span><span class="n">comboAirfoil_coords_xRoot</span> <span class="o">==</span> <span class="mi">0</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span>
                <span class="k">for</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">:</span><span class="n">airfoil_sizeRoot</span><span class="p">(</span><span class="k">end</span><span class="p">)</span>
                     <span class="k">if</span> <span class="n">findYSortedRoot</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">~=</span> <span class="mi">1</span>
                         <span class="n">findYSortedRoot</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
                     <span class="k">else</span>
                         <span class="n">findYSortedRoot</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
                     <span class="k">end</span>
                <span class="k">end</span>
            <span class="k">end</span>
            <span class="c1">% Final array that includes all of the original Y-Axis points</span>
            <span class="c1">% on the correct X-Axis points (includes empty spots)</span>
            <span class="n">rearrangedYArray</span><span class="p">(</span><span class="n">findYSortedRoot</span><span class="p">)</span> <span class="o">=</span> <span class="n">airfoil_coords_yRoot</span><span class="p">(</span><span class="n">findYLocationArrayRoot</span><span class="p">(</span><span class="n">iRoot</span><span class="p">));</span>
        <span class="k">end</span>
</code></pre></div></div>

<p>Code that calculates the slope of each segment and location of each segment on airfoil.</p>

<div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">% Next we need to determine the slope of each segment of the airfoil. This</span>
<span class="c1">% is accomplished by finding all of the empty spots on the rearrangedYArray</span>
<span class="c1">% array. The empty spots are for all of the points that are added in to</span>
<span class="c1">% increase the size of the array so that each array (root and tip) are the</span>
<span class="c1">% same size.</span>

<span class="c1">% Once all of the empty spots are found then need to increment above and</span>
<span class="c1">% below that empty spot to find the two X-Axis and Y-Axis points to input</span>
<span class="c1">% into the slope formula: m = (y2-y1)/(x2-x1).</span>

<span class="c1">% Initialize values</span>
<span class="n">findEmptySpots</span>      <span class="o">=</span> <span class="nb">find</span><span class="p">(</span><span class="n">rearrangedYArray</span> <span class="o">==</span> <span class="mi">0</span><span class="p">);</span>
<span class="n">emptySpotsSlopeRoot</span> <span class="o">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="nb">length</span><span class="p">(</span><span class="n">findEmptySpots</span><span class="p">),</span><span class="mi">1</span><span class="p">);</span>
<span class="n">incBack</span>             <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="n">incFront</span>            <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

<span class="c1">% Determine if start incrementing at the first or second value. If the</span>
<span class="c1">% first value in the array is a zero then start incrementing at 2 otherwise</span>
<span class="c1">% start at 1</span>
<span class="n">iTestStart</span> <span class="o">=</span> <span class="n">findEmptySpots</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">incBack</span><span class="p">;</span>
<span class="k">if</span> <span class="n">iTestStart</span> <span class="o">==</span> <span class="mi">0</span>
    <span class="n">iStart</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
<span class="k">else</span>
    <span class="n">iStart</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="k">end</span>

<span class="c1">% Determine if end incrementing at the last or second to last value. If the</span>
<span class="c1">% end value in the array is a zero then end incrementing at 1 otherwise end</span>
<span class="c1">% at 0</span>
<span class="n">iTestEnd</span> <span class="o">=</span> <span class="n">findEmptySpots</span><span class="p">(</span><span class="k">end</span><span class="p">)</span><span class="o">+</span><span class="n">incFront</span><span class="p">;</span>
<span class="k">if</span> <span class="n">iTestEnd</span> <span class="o">&gt;</span> <span class="nb">length</span><span class="p">(</span><span class="n">rearrangedYArray</span><span class="p">)</span>
    <span class="n">iEnd</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="k">else</span>
    <span class="n">iEnd</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="k">end</span>

<span class="c1">% Grab the first and last values of the Y-Axis array</span>
<span class="n">checkOriginRootStart</span> <span class="o">=</span> <span class="n">airfoil_coords_yRoot</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="n">checkOriginRootEnd</span>   <span class="o">=</span> <span class="n">airfoil_coords_yRoot</span><span class="p">(</span><span class="k">end</span><span class="p">);</span>
    
<span class="c1">% Determine if need to adjust increment values along the empty spots. If</span>
<span class="c1">% the gap between an empty spot is greater than 2, in other words if the</span>
<span class="c1">% above and below value of an empty spot is zero then need to adjust the</span>
<span class="c1">% increment to find a value that is closet to the empty spot and is</span>
<span class="c1">% nonzero.</span>
<span class="k">for</span> <span class="n">i</span> <span class="o">=</span> <span class="n">iStart</span><span class="p">:</span><span class="nb">length</span><span class="p">(</span><span class="n">findEmptySpots</span><span class="p">)</span><span class="o">-</span><span class="n">iEnd</span>
        <span class="n">incBack</span>  <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="n">incFront</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="n">backValue</span>  <span class="o">=</span> <span class="n">rearrangedYArray</span><span class="p">(</span><span class="n">findEmptySpots</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">-</span><span class="n">incBack</span><span class="p">);</span>
        <span class="n">frontValue</span> <span class="o">=</span> <span class="n">rearrangedYArray</span><span class="p">(</span><span class="n">findEmptySpots</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="n">incFront</span><span class="p">);</span>
        
        <span class="c1">% Find nonzero values above the empty spot</span>
        <span class="k">if</span> <span class="n">backValue</span> <span class="o">==</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">incBack</span> <span class="o">=</span> <span class="mi">1</span><span class="p">:</span><span class="mi">20</span>
                <span class="k">if</span> <span class="n">findEmptySpots</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">-</span><span class="n">incBack</span> <span class="o">&lt;=</span> <span class="mi">0</span>
                    <span class="n">incBack</span> <span class="o">=</span> <span class="n">incBack</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
                    <span class="k">break</span>
                <span class="k">end</span>
                <span class="n">backValue</span> <span class="o">=</span> <span class="n">rearrangedYArray</span><span class="p">(</span><span class="n">findEmptySpots</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">-</span><span class="n">incBack</span><span class="p">);</span>
                <span class="k">if</span> <span class="n">backValue</span> <span class="o">~=</span> <span class="mi">0</span>
                    <span class="k">break</span>
                <span class="k">elseif</span> <span class="n">findEmptySpots</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">-</span><span class="n">incBack</span> <span class="o">==</span> <span class="n">midpointCombo</span>
                    <span class="k">break</span>
                <span class="k">elseif</span> <span class="n">rearrangedYArray</span><span class="p">(</span><span class="n">findEmptySpots</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">-</span><span class="n">incBack</span><span class="p">)</span> <span class="o">==</span> <span class="n">checkOriginRootStart</span> <span class="o">&amp;&amp;</span> <span class="n">i</span> <span class="o">==</span> <span class="n">iStart</span>
                    <span class="k">break</span>
                <span class="k">else</span>
                    <span class="k">continue</span>
                <span class="k">end</span>
            <span class="k">end</span>
        <span class="k">end</span>
        
        <span class="c1">% Find nonzero values below the empty spot</span>
        <span class="k">if</span> <span class="n">frontValue</span> <span class="o">==</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">incFront</span> <span class="o">=</span> <span class="mi">1</span><span class="p">:</span><span class="mi">20</span>
                <span class="k">if</span> <span class="n">findEmptySpots</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="n">incFront</span> <span class="o">==</span> <span class="nb">length</span><span class="p">(</span><span class="n">rearrangedYArray</span><span class="p">)</span>
                    <span class="k">break</span>
                <span class="k">elseif</span> <span class="n">findEmptySpots</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="n">incFront</span> <span class="o">&gt;</span> <span class="nb">length</span><span class="p">(</span><span class="n">rearrangedYArray</span><span class="p">)</span>
                    <span class="n">frontValue</span> <span class="o">=</span> <span class="n">frontValue</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
                    <span class="k">break</span>
                <span class="k">end</span>
                <span class="n">frontValue</span> <span class="o">=</span> <span class="n">rearrangedYArray</span><span class="p">(</span><span class="n">findEmptySpots</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="n">incFront</span><span class="p">);</span>
                <span class="k">if</span> <span class="n">frontValue</span> <span class="o">~=</span> <span class="mi">0</span>
                    <span class="k">break</span>
                <span class="k">elseif</span> <span class="n">findEmptySpots</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="n">incFront</span> <span class="o">==</span> <span class="n">midpointCombo</span>
                    <span class="k">break</span>
                <span class="k">elseif</span> <span class="n">rearrangedYArray</span><span class="p">(</span><span class="n">findEmptySpots</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="n">incFront</span><span class="p">)</span> <span class="o">==</span> <span class="n">checkOriginRootEnd</span> <span class="o">&amp;&amp;</span> <span class="n">i</span> <span class="o">==</span> <span class="nb">length</span><span class="p">(</span><span class="n">findEmptySpots</span><span class="p">)</span><span class="o">-</span><span class="n">iEnd</span>
                    <span class="k">break</span>
                <span class="k">else</span>
                    <span class="k">continue</span>
                <span class="k">end</span>
            <span class="k">end</span>
        <span class="k">end</span>
        
    <span class="c1">% Calculates slope across the empty spot</span>
    <span class="k">if</span> <span class="n">findEmptySpots</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">==</span> <span class="n">midpointCombo</span>
        <span class="n">emptySpotsSlopeRoot</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">else</span>
        <span class="n">emptySpotsSlopeRoot</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">rearrangedYArray</span><span class="p">(</span><span class="n">findEmptySpots</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="n">incFront</span><span class="p">)</span><span class="k">...</span>
            <span class="o">-</span> <span class="n">rearrangedYArray</span><span class="p">(</span><span class="n">findEmptySpots</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">-</span> <span class="n">incBack</span><span class="p">))</span> <span class="p">/</span> <span class="p">(</span><span class="n">comboAirfoil_coords_xRoot</span><span class="p">(</span><span class="n">findEmptySpots</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="k">...</span>
            <span class="o">+</span> <span class="n">incFront</span><span class="p">)</span> <span class="o">-</span> <span class="n">comboAirfoil_coords_xRoot</span><span class="p">(</span><span class="n">findEmptySpots</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">-</span> <span class="n">incBack</span><span class="p">));</span>
    <span class="k">end</span>
<span class="k">end</span>

<span class="c1">% Calculates the empty spot value based on the slope across the empty spot</span>
<span class="c1">% and the nearest nonzero value.</span>
<span class="k">for</span> <span class="n">i</span> <span class="o">=</span> <span class="n">iStart</span><span class="p">:</span><span class="nb">length</span><span class="p">(</span><span class="n">findEmptySpots</span><span class="p">)</span><span class="o">-</span><span class="n">iEnd</span>
        <span class="n">rearrangedYArray</span><span class="p">(</span><span class="n">findEmptySpots</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="o">=</span> <span class="n">rearrangedYArray</span><span class="p">(</span><span class="n">findEmptySpots</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span><span class="k">...</span>
            <span class="n">emptySpotsSlopeRoot</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">.*</span> <span class="p">(</span><span class="n">comboAirfoil_coords_xRoot</span><span class="p">(</span><span class="n">findEmptySpots</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="o">-</span> <span class="n">comboAirfoil_coords_xRoot</span><span class="p">(</span><span class="n">findEmptySpots</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">));</span>
        
        <span class="k">if</span> <span class="n">findEmptySpots</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">==</span> <span class="n">midpointCombo</span>
            <span class="n">rearrangedYArray</span><span class="p">(</span><span class="n">findEmptySpots</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">end</span>
<span class="k">end</span>

<span class="c1">% Sets the final combined airfoil Y-Axis array to the final</span>
<span class="c1">% rearrangedYArray array (empty spots are filled in)</span>
<span class="n">comboAirfoil_coords_yRoot</span> <span class="o">=</span> <span class="n">rearrangedYArray</span><span class="p">;</span>
</code></pre></div></div>

<p>Here are the finished airfoils for the root and tip, the NACA 2412 and NACA 63(1)-212.</p>

<div>
    <iframe type="text/html" src="combo_naca2412.html" width="150" height="3200"></iframe>
    <iframe type="text/html" src="combo_naca63-212.html" width="150" height="3200"></iframe>
</div>

<p>Finally, here is the code that plots the wing. Note how rather then using a FOR loop to create the wing by drawing a face connecting both segments together on the root and tip, a surface function is used which creates the wing by lofting a surface between the root and tip airfoils.  The above process still holds true, where the X-Axis points need to be in the same location across the root and tip for the loft to work. A FOR loop would still work, but a surface is faster and also allows for shading the model. I showed the steps of using a FOR loop to help better understand the overall process.</p>

<div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">% X-Coordinates</span>
<span class="n">XW1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="n">XW2</span><span class="o">=</span><span class="n">XW1</span> <span class="o">+</span> <span class="p">(</span><span class="n">b</span><span class="p">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="nb">tand</span><span class="p">(</span><span class="n">LamLE</span><span class="p">);</span>
<span class="n">XW3</span><span class="o">=</span><span class="n">XW2</span><span class="o">+</span><span class="n">tipChord</span><span class="p">;</span>
<span class="n">XW4</span><span class="o">=</span><span class="n">XW1</span><span class="o">+</span><span class="n">rootChord</span><span class="p">;</span>

<span class="c1">% Z-Coordinates</span>
<span class="n">ZW1</span><span class="o">=</span><span class="n">rootChord</span><span class="o">*</span><span class="nb">sind</span><span class="p">(</span><span class="n">i_w</span><span class="p">);</span>
<span class="n">ZW2</span><span class="o">=</span><span class="p">(</span><span class="n">XW4</span><span class="o">-</span><span class="n">XW2</span><span class="p">)</span><span class="o">*</span><span class="nb">sind</span><span class="p">(</span><span class="n">i_w</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">b</span><span class="p">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="nb">tand</span><span class="p">(</span><span class="n">Gam</span><span class="p">);</span>
<span class="n">ZW3</span><span class="o">=</span><span class="p">(</span><span class="n">XW4</span><span class="o">-</span><span class="n">XW3</span><span class="p">)</span><span class="o">*</span><span class="nb">sind</span><span class="p">(</span><span class="n">i_w</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">b</span><span class="p">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="nb">tand</span><span class="p">(</span><span class="n">Gam</span><span class="p">);</span>

<span class="n">XWRRoot</span> <span class="o">=</span> <span class="p">((</span><span class="n">comboAirfoil_coords_xRoot</span><span class="p">)</span><span class="o">.*</span><span class="n">rootChord</span><span class="p">)</span><span class="o">+</span><span class="n">XW1</span><span class="p">;</span>
<span class="n">XWRTip</span>  <span class="o">=</span> <span class="p">((</span><span class="n">comboAirfoil_coords_xTip</span><span class="o">.*</span><span class="n">tipChord</span><span class="p">)</span><span class="o">+</span><span class="n">XW2</span><span class="p">);</span>

<span class="n">YWRT</span> <span class="o">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="nb">length</span><span class="p">(</span><span class="n">XWRRoot</span><span class="p">),</span><span class="mi">2</span><span class="p">);</span>

<span class="n">ZWRRoot</span> <span class="o">=</span> <span class="p">((</span><span class="n">comboAirfoil_coords_yRoot</span><span class="p">)</span><span class="o">.*</span><span class="n">rootChord</span><span class="p">)</span><span class="o">+</span><span class="n">ZW1</span><span class="p">;</span>
<span class="n">ZWRTip</span> <span class="o">=</span> <span class="p">((</span><span class="n">comboAirfoil_coords_yTip</span><span class="p">)</span><span class="o">.*</span><span class="n">tipChord</span><span class="p">)</span><span class="o">+</span><span class="n">ZW2</span><span class="p">;</span>

<span class="n">YWRT</span><span class="p">(:,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="n">YWRT</span><span class="p">(:,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">b</span><span class="p">/</span><span class="mi">2</span><span class="o">-</span><span class="p">((</span><span class="n">b</span><span class="p">/</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="n">b</span><span class="p">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="nb">cosd</span><span class="p">(</span><span class="n">Gam</span><span class="p">));</span>
<span class="n">XWRT</span> <span class="o">=</span> <span class="p">[</span><span class="n">XWRRoot</span><span class="p">,</span><span class="n">XWRTip</span><span class="p">];</span>
<span class="n">ZWRT</span> <span class="o">=</span> <span class="p">[</span><span class="n">ZWRRoot</span><span class="p">,</span><span class="n">ZWRTip</span><span class="p">];</span>

<span class="c1">% Plot Right Wing</span>
<span class="n">WRT</span> <span class="o">=</span> <span class="nb">surface</span><span class="p">(</span><span class="n">XWRT</span><span class="p">,</span><span class="n">YWRT</span><span class="p">,</span><span class="n">ZWRT</span><span class="p">);</span>
</code></pre></div></div>
<h5>Finished Wing Segment</h5>
<h6>Isometric View</h6>
<p><img class="img-fluid" src="../img/pac_project/combined_airfoils_wing.png" /></p>

<h6>Side View</h6>
<p><img class="img-fluid" src="../img/pac_project/combo.png" /></p>

</div>

<footer class="navbar navbar-expand navbar-light bg-light bg-gradient border-top">
  <div class="container-fluid">
    <div class="ms-auto">
      <ul class="navbar-nav mb-2 mb-lg-0">
        <small><a class="nav-link" href="https://www.youtube.com/watch?v=mfQjG4t4M08">Engineering is awesome!</a></small>
      </ul>
    </div>
  </div>
</footer>


  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/js/bootstrap.bundle.min.js" integrity="sha384-pprn3073KE6tl6bjs2QrFaJGz5/SUsLqktiwsUTF55Jfv3qYSDhgCecCxMW52nD2" crossorigin="anonymous"></script>
  </body>
</html>
